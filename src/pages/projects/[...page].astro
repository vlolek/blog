---
import type { GetStaticPaths, Page } from 'astro'
import type { CollectionEntry } from 'astro:content'
import { PROJECTS_CONFIG } from '~/config'
import { getAllProjects } from '~/lib/data'
import Layout from '~/layouts/Layout.astro'
import Pagination from '~/components/base/Pagination.astro'
import List from '~/components/posts/card/List.astro'
import PageTitle from '~/components/base/PageTitle.astro'

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const sortedProjects = await getAllProjects()

  return paginate(sortedProjects, {
    pageSize: PROJECTS_CONFIG.postPageConfig.size,
  })
}

interface Props {
  page: Page<CollectionEntry<'projects'>>
}

const { page } = Astro.props

const { title, description, introduce } = PROJECTS_CONFIG
---

<Layout {title} {description}>
  <div class="relative z-[1] py-8 pb-10 px-6 sm:px-8">
    <PageTitle {title} {introduce} />
    <div class="mt-12 fade-up">
      <List posts={page.data} type={PROJECTS_CONFIG.postPageConfig.type} coverLayout={PROJECTS_CONFIG.postPageConfig?.coverLayout} baseUrl="/projects" />
    </div>
    <Pagination {page} baseUrl="/projects" />
  </div>
</Layout>

